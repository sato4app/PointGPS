# PointGPS 利用者の手引（2025年9月版）

## はじめに

PointGPSは、国土地理院地図上でGPSポイントを簡単に管理できるWebアプリケーションです。このガイドでは、初心者から上級者まで、効率的にアプリを使用する方法を説明します。

## 目次

1. [セットアップ](#セットアップ)
2. [基本操作](#基本操作)
3. [データの読み込み](#データの読み込み)
4. [ポイント操作](#ポイント操作)
5. [データの出力](#データの出力)
6. [高度な機能](#高度な機能)
7. [トラブルシューティング](#トラブルシューティング)
8. [よくある質問](#よくある質問)

## セットアップ

### 動作環境
- **ブラウザ**: Chrome、Firefox、Safari、Edge（最新版推奨）
- **ネットワーク**: インターネット接続必須（地図データ取得のため）
- **ローカルサーバー**: ファイル読み込みにはローカルサーバーが必要

### 起動方法
1. **ローカルサーバーを起動**
   ```bash
   # Pythonを使用
   python -m http.server 8000
   
   # またはnpm serveを使用
   npx serve .
   ```

2. **ブラウザでアクセス**
   - `http://localhost:8000` を開く
   - PointGPSアプリが表示されます

## 基本操作

### 画面構成
- **地図エリア**: メインの地図表示（左側）
- **操作パネル**: ポイント編集ツール（右側）
- **メッセージエリア**: 操作結果の通知（上部）

### 地図操作
- **ズーム**: マウスホイール、またはズームボタン（+/-）
- **パン**: 地図をドラッグして移動
- **スケール**: 右下にスケールバー表示

## データの読み込み

### Excelファイルの読み込み

1. **「読込(Excel)」ボタンをクリック**
2. **Excelファイル(.xlsx)を選択**
3. **ファイル形式の要件**:
   - 拡張子: .xlsx
   - 列構成: ポイントID、緯度、経度、標高、場所名
   - データ形式: 適切な数値・文字列形式

4. **読み込み結果**:
   - 成功時: ポイントが地図上に表示
   - ポイント数がカウンター表示
   - 確認メッセージが表示

### GeoJSONファイルの読み込み

1. **「読込(GeoJSON)」ボタンをクリック**
2. **GeoJSONファイル(.geojson)を選択**
3. **Point geometry形式のFeatureCollectionに対応**

### 読み込み時の注意事項
- **大容量ファイル**: メモリ不足を避けるため、適切なサイズのファイルを使用
- **データ検証**: 不正なデータは自動的にスキップまたは修正
- **重複チェック**: 同一ポイントIDは上書きされます

## ポイント操作

### ポイント追加

1. **「追加」ボタンをクリック**
2. **カーソルがクロスヘアに変化**
3. **地図上の任意の場所をクリック**
4. **新しいポイントが追加され、自動選択される**

**Tips**: 
- ESCキーで追加モードを終了
- 追加されたポイントには自動的にIDが割り当てられます

### ポイント選択

1. **地図上のポイント（赤い円）をクリック**
2. **選択されたポイントは緑色に変化**
3. **右側パネルにポイント情報が表示**

### ポイント移動

1. **移動したいポイントを選択**
2. **「移動」ボタンをクリック**
   - ボタンが緑色（ライムグリーン）に変化
3. **選択されたポイントをドラッグして移動**
   - ドラッグ中は座標情報がリアルタイム更新
4. **ドロップ時に移動完了**
   - GPS標高が自動再取得
   - 移動モードが自動解除

**移動モードの解除方法**:
- ドラッグ完了時（自動）
- 他のポイントをクリック
- 「追加」「削除」ボタンをクリック
- ESCキーを押下

### ポイント削除

1. **削除したいポイントを選択**
2. **「削除」ボタンをクリック**
3. **確認ダイアログで「OK」**
4. **ポイントが地図から削除される**

### ポイント情報編集

選択されたポイントの情報は右側パネルで編集できます：

- **ポイントID**: 最大5文字、編集可能
- **緯度/経度**: 自動計算、読み取り専用
- **DMS**: 度分秒形式、読み取り専用
- **標高**: 手動入力可能
- **GPS標高**: API自動取得、読み取り専用
- **場所名**: 最大20文字、編集可能

## データの出力

### Excel形式で出力

1. **「出力(Excel)」ボタンをクリック**
2. **保存場所とファイル名を指定**
3. **全ポイント情報が.xlsx形式で保存**

### GeoJSON形式で出力

1. **「出力(GeoJSON)」ボタンをクリック**
2. **保存場所とファイル名を指定**
3. **全ポイント情報が.geojson形式で保存**

**出力ファイルの特徴**:
- **Excel**: 表形式で人間が読みやすい
- **GeoJSON**: GISソフトウェアで利用可能
- **ファイル名**: デフォルトで日時が自動付与

## 高度な機能

### GPS標高の自動取得

- **取得タイミング**: ポイント選択時、移動完了時
- **データソース**: 国土地理院標高API
- **取得条件**: GPS標高が未設定の場合のみ初回取得
- **再取得**: ポイント移動時は強制的に再取得

### 座標表示形式

アプリケーションは2つの座標表示形式に対応：

1. **10進数形式**: 35.12345, 135.67890
2. **度分秒形式**: 135°40'44.04"E 35°7'24.42"N

### リアルタイム更新

移動モード中は以下の情報がリアルタイム更新：
- 緯度・経度（10進数）
- DMS座標
- ポイントマーカーの位置

## トラブルシューティング

### よくあるエラーと対処法

#### 「ファイルが読み込めません」
- **原因**: ファイル形式不正、ファイル破損
- **対処**: ファイル形式を確認、別のファイルで試行

#### 「地図が表示されません」
- **原因**: ネットワーク接続問題
- **対処**: インターネット接続を確認

#### 「ポイントをドラッグできません」
- **原因**: 移動モードが有効でない
- **対処**: ポイント選択後、移動ボタンをクリック

#### 「GPS標高が取得できません」
- **原因**: API接続エラー、対象地域外
- **対処**: しばらく待ってから再試行

### パフォーマンスの最適化

#### 大量ポイントでの動作が重い場合
1. **ブラウザのメモリクリア**
2. **不要なタブを閉じる**
3. **ポイント数を適切な範囲に調整**

#### 地図表示が遅い場合
1. **ネットワーク速度を確認**
2. **ズームレベルを調整**
3. **ブラウザキャッシュをクリア**

## よくある質問

### Q: 対応しているファイル形式は？
**A**: 入力は.xlsxと.geojson、出力は.xlsxと.geojsonに対応しています。

### Q: 最大何個のポイントを扱えますか？
**A**: 技術的な上限はありませんが、ブラウザのメモリに依存します。数千点程度まで快適に動作します。

### Q: オフラインで使用できますか？
**A**: 地図表示にはインターネット接続が必要です。ポイント編集などの基本機能は接続なしでも動作します。

### Q: スマートフォンで使用できますか？
**A**: はい。タッチ操作に対応しており、スマートフォンやタブレットでも使用可能です。

### Q: データのバックアップは？
**A**: 定期的にExcelまたはGeoJSON形式でエクスポートすることをお勧めします。

### Q: 座標系は何を使用していますか？
**A**: WGS84（緯度経度）座標系を使用しています。

### Q: 商用利用は可能ですか？
**A**: ライセンス条項を確認してください。地理院タイルの利用規約も準拠する必要があります。

## サポート情報

### 技術サポート
- **ドキュメント**: README.md、funcspec.mdを参照
- **ソースコード**: JavaScript ES6 modules構成
- **開発環境**: ローカルサーバーでの動作推奨

### アップデート情報
- **定期更新**: 機能追加、バグ修正
- **互換性**: データファイルの後方互換性維持
- **変更履歴**: CHANGELOG.mdで確認可能

---

**最終更新**: 2025年9月  
**バージョン**: 1.0  
**対象ブラウザ**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+