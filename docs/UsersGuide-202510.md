# PointGPS 利用者の手引

**バージョン**: 2.0
**最終更新日**: 2025年10月27日

---

## 目次

1. [はじめに](#はじめに)
2. [動作環境](#動作環境)
3. [起動方法](#起動方法)
4. [基本操作](#基本操作)
5. [データ管理](#データ管理)
6. [便利な機能](#便利な機能)
7. [トラブルシューティング](#トラブルシューティング)
8. [よくある質問](#よくある質問)

---

## はじめに

### PointGPSとは

PointGPSは、国土地理院地図上でGPSポイントの表示、編集、管理を行うWebアプリケーションです。ハイキングやトレッキング、観光スポットの記録など、様々な用途でご利用いただけます。

### 主な特徴

- **簡単操作**: クリック・ドラッグの直感的な操作
- **Excel対応**: 使い慣れたExcel形式でデータ管理
- **自動標高取得**: 国土地理院のデータから標高を自動取得
- **高速処理**: 100ポイントを約0.3-0.5秒で読み込み
- **重複防止**: 同じ場所に誤ってポイントを追加することを防止

---

## 動作環境

### 推奨ブラウザ

- Google Chrome 90以上
- Mozilla Firefox 88以上
- Microsoft Edge 90以上
- Safari 14以上

### 必要な環境

- **インターネット接続**: 地図表示と標高取得に必要
- **HTTPサーバー**: ローカル環境で使用する場合に必要

---

## 起動方法

### ローカル環境での起動

1. **HTTPサーバーの起動**

   Pythonをお使いの場合:
   ```bash
   python -m http.server 8000
   ```

   npmをお使いの場合:
   ```bash
   npx serve .
   ```

2. **ブラウザでアクセス**

   ブラウザで以下のURLを開きます:
   ```
   http://localhost:8000
   ```

### 注意事項

- ファイルを直接ブラウザで開く（`file://`プロトコル）と正常に動作しません
- 必ずHTTPサーバー経由でアクセスしてください

---

## 基本操作

### 1. データの読み込み

#### 手順

1. **「ポイント読み込み(Excel)」ボタンをクリック**
   - パネル上部にあるボタンです

2. **Excelファイルを選択**
   - `.xlsx`形式のファイルのみ対応しています
   - 最大1,000行まで読み込めます

3. **読み込み完了**
   - 地図上にポイントが表示されます
   - 「○○個のポイントを読み込みました」というメッセージが表示されます

#### Excelファイルの形式

必須の列（ヘッダー名は完全一致）:
- **ポイントID**: ポイントの識別子（例: `P-01`）
- **名称**: 場所の名前（例: `箕面大滝`）
- **緯度**: 緯度（例: `34.853667`）
- **経度**: 経度（例: `135.472041`）

任意の列:
- **標高**: 標高（メートル）
- **備考**: メモや補足情報

#### 座標の入力方法

以下の形式に対応しています:

- **10進数形式**: `34.853667`
- **度分秒形式**: `34°51'13.2"N`

---

### 2. ポイントの追加

#### 手順

1. **「追加」ボタンをクリック**
   - カーソルが十字に変わります

2. **地図上の任意の場所をクリック**
   - 新しいポイントが追加されます
   - 仮ID（`仮01`、`仮02`など）が自動的に付けられます

3. **ポイント情報を入力**
   - ポイントIDフィールドが自動的に選択されます
   - 必要な情報を入力してください

#### 重複防止機能

- 既存のポイントの近く（約10ピクセル以内）にカーソルを移動すると、カーソルが禁止マークに変わります
- その場所をクリックしても、「既存のポイント○○と同じ場所には追加できません」という警告が表示され、追加されません

#### 標高の自動取得

- ポイントを追加すると、国土地理院のデータから標高が自動的に取得されます
- 取得には1-2秒かかる場合があります

---

### 3. ポイントの選択

#### 手順

1. **地図上のマーカーをクリック**
   - マーカーの色が緑からライムグリーンに変わります
   - パネルにポイントの詳細情報が表示されます

#### 表示される情報

- **ポイントID**: ポイントの識別子
- **名称**: 場所の名前
- **緯度**: 緯度（10進数、小数点以下5桁）
- **経度**: 経度（10進数、小数点以下5桁）
- **DMS**: 緯度・経度（度分秒形式）
- **標高**: GPS標高（メートル、小数点以下1桁）
- **備考**: メモや補足情報

---

### 4. ポイントの移動

#### 手順

1. **移動したいポイントを選択**
   - 地図上のマーカーをクリックします

2. **「移動」ボタンをクリック**
   - 移動ボタンがライムグリーンに変わります
   - カーソルが移動マークに変わります

3. **マーカーをドラッグ**
   - マーカーをクリックしたまま移動したい場所まで動かします
   - ドラッグ中は緯度・経度・DMSがリアルタイムで更新されます

4. **マウスボタンを離す**
   - 新しい位置が確定します
   - 「ポイント○○を移動しました」というメッセージが表示されます
   - 標高が自動的に再取得されます
   - 移動モードが自動的に解除されます

#### 移動モードの解除

以下の操作で移動モードが自動的に解除されます:
- マーカーのドラッグ完了時
- ESCキーを押した時
- 他のポイントをクリックした時
- 他のボタン（追加、削除）をクリックした時

---

### 5. ポイントの削除

#### 手順

1. **削除したいポイントを選択**
   - 地図上のマーカーをクリックします

2. **「削除」ボタンをクリック**
   - 確認ダイアログが表示されます

3. **確認ダイアログでOKをクリック**
   - ポイントが削除されます
   - 「ポイント○○を削除しました」というメッセージが表示されます

#### 注意事項

- 削除したポイントは元に戻せません
- 削除前に必ずデータをエクスポートして保存することをお勧めします

---

### 6. ポイント情報の編集

#### 編集可能な項目

- **ポイントID**: 最大5文字
- **名称**: 最大20文字
- **備考**: 最大50文字

#### 編集方法

1. **ポイントを選択**
2. **フィールドをクリックして編集**
3. **Tabキーまたは他のフィールドをクリック**
   - 変更が自動的に保存されます

#### ポイントIDの自動フォーマット

ポイントIDを入力すると、以下のように自動的にフォーマットされます:

- **全角→半角**: `Ｐ１` → `P1`
- **小文字→大文字**: `p1` → `P1`
- **0パディング**: `P1` → `P01`
- **ハイフン挿入**: `P01` → `P-01`

例:
- 入力: `ｐ１` → 自動変換: `P-01`
- 入力: `a3` → 自動変換: `A-03`

---

### 7. データの出力

#### 手順

1. **「ポイント出力(Excel)」ボタンをクリック**
   - ファイル保存ダイアログが表示されます

2. **保存場所とファイル名を指定**
   - デフォルトファイル名: `ポイントGPS-yyyymmdd.xlsx`
   - 必要に応じてファイル名を変更できます

3. **保存ボタンをクリック**
   - Excelファイルが保存されます
   - 「Excelファイルを保存しました」というメッセージが表示されます

#### 出力内容

- **シート名**: `ポイントGPS`
- **列**: ポイントID、名称、緯度、経度、標高、備考
- **緯度・経度**: 小数点以下5桁
- **標高**: 数値型（Excelで計算可能）

#### ブラウザ互換性

- **Chrome、Edge等**: ダイアログで保存場所を選択可能
- **古いブラウザ**: 自動的にダウンロードフォルダに保存

---

## データ管理

### データのバックアップ

PointGPSはブラウザ上で動作するため、データは一時的にメモリに保存されています。以下の場合、データが失われます:

- ブラウザをリロード（再読み込み）した時
- ブラウザを閉じた時
- ページを離れた時

**重要**: 定期的にExcelファイルとして出力して保存してください。

### データの更新サイクル

推奨される作業フロー:

1. **Excelファイルを読み込む**
2. **ポイントを編集・追加・削除**
3. **Excelファイルとして出力**
4. **作業終了**

### データの整合性

- ポイントIDは重複しないようにしてください
- 座標値は日本国内の範囲内にしてください（緯度: 20-46度、経度: 122-154度）

---

## 便利な機能

### キーボードショートカット

| キー | 機能 |
|------|------|
| ESC | 追加・移動モードをキャンセル |
| Tab | 次のフィールドに移動 |

### タブ順序

効率的な入力のため、以下の順序でフィールド間を移動できます:

1. ポイントID
2. 名称
3. 備考

（読み取り専用フィールドはスキップされます）

### マーカーのツールチップ

- マーカーにマウスカーソルを合わせると、ポイントIDが表示されます
- ポイントの識別に便利です

### ポイント数の確認

- パネル上部の「ポイント数」フィールドで、現在読み込まれているポイント数を確認できます

### 地図操作

- **ズーム**: 左上または右下のズームボタン、またはマウスホイール
- **移動**: 地図をドラッグ
- **スケール**: 右下にメートル単位のスケールバーが表示されます

---

## トラブルシューティング

### 地図が表示されない

#### 原因と対処法

1. **インターネット接続を確認**
   - 地図タイルの読み込みにインターネット接続が必要です

2. **HTTPサーバー経由でアクセスしているか確認**
   - URLが`http://localhost:8000`のような形式になっているか確認
   - `file://`で始まる場合は、HTTPサーバーを起動してください

3. **ブラウザのコンソールでエラーを確認**
   - F12キーを押してデベロッパーツールを開く
   - コンソールタブでエラーメッセージを確認

### Excelファイルが読み込めない

#### 原因と対処法

1. **ファイル形式を確認**
   - `.xlsx`形式のみ対応しています
   - 古い`.xls`形式は非対応です

2. **ヘッダー行を確認**
   - 必須列が存在するか確認: `ポイントID`、`名称`、`緯度`、`経度`
   - 列名は完全一致が必要です（全角・半角、スペース等に注意）

3. **データ内容を確認**
   - 緯度・経度が数値または度分秒形式になっているか確認
   - 必須項目が空欄になっていないか確認

4. **行数を確認**
   - 1,000行を超えていないか確認
   - 超えている場合は、ファイルを分割してください

### 標高が取得できない

#### 原因と対処法

1. **インターネット接続を確認**
   - 標高APIの利用にインターネット接続が必要です

2. **座標が日本国内か確認**
   - 国土地理院標高APIは日本国内のみ対応しています

3. **しばらく待つ**
   - API取得には1-2秒かかる場合があります

4. **ブラウザのコンソールを確認**
   - APIエラーが出ていないか確認

### ポイントが追加できない

#### 原因と対処法

1. **既存ポイントの近くでないか確認**
   - カーソルが禁止マークになっている場合、そこには追加できません
   - 少し離れた場所をクリックしてください

2. **追加モードになっているか確認**
   - 「追加」ボタンをクリックしているか確認
   - カーソルが十字になっているか確認

### ファイルが保存できない

#### 原因と対処法

1. **ブラウザの権限を確認**
   - ブラウザがファイル保存の権限を持っているか確認

2. **ダウンロードフォルダを確認**
   - 古いブラウザでは自動的にダウンロードフォルダに保存されます

3. **保存をキャンセルしていないか確認**
   - ダイアログでキャンセルを押していないか確認

---

## よくある質問

### Q1. オフラインで使用できますか？

**A**: いいえ、できません。地図表示と標高取得にインターネット接続が必要です。

### Q2. スマートフォンで使用できますか？

**A**: はい、できます。レスポンシブデザインに対応しており、スマートフォンやタブレットでも使用できます。

### Q3. データはどこに保存されますか？

**A**: ブラウザの一時メモリに保存されます。ブラウザを閉じるとデータは失われるため、必ずExcelファイルとして出力してください。

### Q4. 1,000点以上のポイントを管理できますか？

**A**: 技術的には可能ですが、性能が低下する可能性があります。大量のポイントを扱う場合は、地域やカテゴリごとにファイルを分割することをお勧めします。

### Q5. ポイントIDの形式は何ですか？

**A**: 自由に設定できますが、自動フォーマット機能により「英字-数字2桁」形式（例: `P-01`）に整形されます。日本語も使用可能です。

### Q6. 座標はどの形式で入力すればよいですか？

**A**: 10進数形式（例: `34.853667`）または度分秒形式（例: `34°51'13.2"N`）のどちらでも入力できます。自動的に10進数に変換されます。

### Q7. 標高は手動で入力できますか？

**A**: 現在のバージョンでは、標高は自動取得のみです。手動入力機能は将来のバージョンで対応予定です。

### Q8. ルート（線）を描画できますか？

**A**: 現在のバージョンでは、ポイント（点）のみ対応しています。ルート描画機能は将来のバージョンで対応予定です。

### Q9. CSVファイルは使えますか？

**A**: 現在のバージョンでは、Excel (.xlsx) のみ対応しています。

### Q10. データを他のアプリケーションと共有できますか？

**A**: はい、Excel形式で出力できるため、Excel、Google Sheets等の表計算ソフトで開いて編集・共有できます。

---

## お問い合わせ

### バグ報告・機能要望

GitHubリポジトリのIssuesセクションで報告をお願いします。

### 技術サポート

README.mdまたはCLAUDE.mdを参照してください。

---

**© 2025 PointGPS Development Team. All rights reserved.**

最終更新: 2025年10月27日
